{% extends "base-center.html" %}
{% block content_center %}
    <div id="stats" class="alert alert-primary my-3" role="alert">
        Analysis and visualization of {{ stats['n_studies'] }} datasets containing {{ "{:,}".format(stats['n_cells']) }} individual samples.
    </div>
    <table class="table table-hover table-sm">
        <thead>
            <tr>
                <th></th>
                <th></th>
                <th>ID</th>
                <th>Samples</th>
                <th>Genes</th>
                <th>Submission date</th>
                <th>Link to upload page</th>
            </tr>
        </thead>
        <tbody>
            {% for gds in geo_datasets %}
            <tr>
                <td><a href="graph_page/{{ gds['id'] }}/tSNE" class="btn btn-outline-info btn-sm">Launch Viewer</a></td>
                <td>
                    {% if gds.get('notebook_uid') is not none %}
                        <a href="view_notebook/{{gds['notebook_uid']}}/{{gds['id']}}" 
                            class="btn btn-outline-info btn-sm" target="_blank">Launch Notebook</a>
                    {% else %}
                        <a class="btn btn-outline-info btn-sm disabled">Launch Notebook</a>
                    {% endif %}
                </td>
                <td>{{ gds['id'] }}</td>
                <td>{{ gds['n_cells'] }}</td>
                <td>{{ gds['n_genes'] }}</td>
                <td>{{ gds['upload']['_id'].generation_time }}</td>
                <td>
                    <a href="preprocess/{{ gds['upload']['_id']|string }}" target="_blank">{{ gds['upload']['_id']|string }}</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% endblock %}
{% block scripts %}
<script src="node_modules/datatables.net/js/jquery.dataTables.js"></script>
<script src="node_modules/datatables.net-bs4/js/dataTables.bootstrap4.js"></script>
<script src="node_modules/moment/min/moment.min.js"></script>
<script src="//cdn.datatables.net/plug-ins/1.10.19/sorting/datetime-moment.js"></script>
<script type="text/javascript">
    // init moment.js date column
    $.fn.dataTable.moment('MMM DD YYYY');
    $('.table').DataTable({
        ordering: true,
        pageLength: 25,
        order: [[5, 'desc']]
    })
</script>
{% endblock %}
